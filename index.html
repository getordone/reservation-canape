<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Réservation de Canapé</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f9;
        }
        .canape {
            position: relative;
            display: inline-block;
        }
        .place {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: green;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .place.reservee {
            background-color: red;
            cursor: not-allowed;
        }
        .place:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <h1>Réservation de place sur le canapé</h1>
    <p>Clique sur une place disponible pour réserver !</p>
    <div class="canape">
        <img src="canape.jpg" alt="Canapé" style="width: 500px;">
    </div>
    <script>
        const apiURL = "https://raw.githubusercontent.com/getordone/reservation-canape/refs/heads/main/reservations.json";
        const places = [
            { id: 1, top: 160, left: 120 },
            { id: 2, top: 150, left: 180 },
            { id: 3, top: 130, left: 240 },
            { id: 4, top: 140, left: 340 },
            { id: 5, top: 170, left: 395 },
        ];

        const canape = document.querySelector('.canape');

        // Charger les réservations depuis le fichier JSON
        async function chargerReservations() {
            try {
                const response = await fetch(apiURL);
                const reservations = await response.json();
                Object.keys(reservations).forEach(id => {
                    const place = document.querySelector(`[data-id="${id}"]`);
                    if (place) {
                        place.classList.add('reservee');
                        place.textContent = reservations[id];
                    }
                });
            } catch (error) {
                console.error("Erreur lors du chargement des réservations :", error);
            }
        }

        // Fonction pour mettre à jour une réservation
        async function reserverPlace(id, nom) {
            // Pour une solution simple, tu ne peux pas écrire directement sur GitHub via fetch.
            // Il faut implémenter un backend ou modifier manuellement le fichier.
            alert("Pour écrire sur GitHub, il faut un script côté serveur !");
        }

        // Générer les places sur le canapé
        places.forEach(place => {
            const div = document.createElement('div');
            div.className = 'place';
            div.style.top = place.top + 'px';
            div.style.left = place.left + 'px';
            div.textContent = place.id;
            div.dataset.id = place.id;
            canape.appendChild(div);

            div.addEventListener('click', () => {
                if (div.classList.contains('reservee')) {
                    alert("Cette place est déjà réservée !");
                } else {
                    const nom = prompt("Entrez votre prénom pour réserver :");
                    if (nom) {
                        div.classList.add('reservee');
                        div.textContent = nom;
                        reserverPlace(place.id, nom);
                    }
                }
            });
        });

        // Charger les réservations au démarrage
        chargerReservations();
    </script>
</body>
</html>